(()=>{"use strict";(()=>{const e=(e=document,t)=>e.querySelector(t);function t(){const e=this.node,t=Array.from((new DOMParser).parseFromString(this.template(),"text/html").body.children),s=new DocumentFragment;s.append(...t),e.after(s),this.node=e.nextSibling;const n=e.classList.value.trim(),i=this.node.classList.value.trim(),a=n!==i&&i||n;a?(this.node.className=a,e.remove()):e.remove()}var s=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{o(n.next(e))}catch(e){a(e)}}function l(e){try{o(n.throw(e))}catch(e){a(e)}}function o(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,l)}o((n=n.apply(e,t||[])).next())}))};class n{constructor({node:e,initalState:t,renderStateKey:s=[]}){this.node=e,this.initalState=t,this.renderStateKey=new Set(s),this.subscribers=new Set([]),this.isNeedRender=!1,this.isNeedUpdate=!1,this.setup(),this.render()}setup(){}render(){window.requestAnimationFrame((()=>{t.call(this),this.setEvent(),this.renderChildComponent()}))}updater(){this.isNeedRender?(this.clearEvent(),this.render()):this.renderChildComponent()}renderChildComponent(){}setEvent(){}clearEvent(){}template(){return""}subscribe(...e){e.forEach((e=>{this.subscribers.add(e)}))}notify(e){Array.from(this.subscribers).forEach((t=>{t.setState(e),t.updater(),t.isNeedRender=!1}))}setState(e){this.checkUpdataState(e),this.isNeedUpdate&&(this.reflectNeedRender(e),this.reflectState(e),this.notify(e),((e,t)=>{try{localStorage.setItem("searchState",JSON.stringify(t))}catch(e){throw new Error("저장이 되지 않았습니다!")}})(0,this.initalState))}checkUpdataState(e){const t=JSON.stringify(Object.assign({},this.initalState)),s=JSON.stringify(Object.assign(Object.assign({},this.initalState),e));this.isNeedUpdate=t!==s}reflectNeedRender(e){const t=Object.keys(e),s=Array.from(this.renderStateKey),n=t.filter((e=>s.includes(e)));this.isNeedRender=0===n.length}reflectState(e){Object.keys(e).forEach((t=>{const s=t;this.initalState[s]=e[s]}))}}const i={SearchInput__input:"oZFdS8AMjR5RMYyBNvKV"};class a extends n{template(){const{SearchInput__input:e}=i,{keyword:t}=this.initalState;return`\n      <input class='${e}' type='text' placeholder='웹툰제목, 작가이름으로 검색' value='${t}'/>\n    `}setup(){const{onInput:e}=this.initalState;this.handleInput=t=>{e(t.target.value)},this.handleFocus=()=>{this.node.focus()}}setEvent(){this.node.addEventListener("input",this.handleInput),this.handleFocus()}clearEvent(){this.node.removeEventListener("input",this.handleInput)}}const r={result_list:"hjCdco27lJJTo2oyRN5w",selected:"yqBqWxiR9AStGB58rLfS",matched:"OAf5JwkD9oSOJWplWK_0"};class l extends n{template(){var e;const{selectedIndex:t,isResultListVisiable:s,listData:n,keyword:i}=this.initalState,{result_list:a,selected:l,matched:o}=r,c=(e,t)=>{if(!e.includes(t))return e;const s=e.match(new RegExp(t,"gi"))[0];return e.replace(new RegExp(s,"gi"),`<span class='${o}'>${s}</span>`)};return`\n      <ul class='${s?`${a}`:"hide"}'>${null===(e=Array.from(n))||void 0===e?void 0:e.map(((e,s)=>`<li class='${s===t?`${l}`:""}' data-index='${s}'>\n              <span>${c(e.title,i)}</span>\n              <span>[ ${c(e.author,i)} ] </span>\n            </li>`)).join("")}\n      </ul>\n    `}setup(){const{onClick:e}=this.initalState;this.handleClick=t=>{const s=t.target.closest("li");if(s){const{index:t}=s.dataset;e(this.initalState.listData[parseInt(t)],t)}}}setEvent(){this.node.addEventListener("click",this.handleClick);const{selectedIndex:e}=this.initalState;(e>0&&e<=3||0===e)&&this.node.scrollTo(0,0),e>3&&this.node.scrollTo(0,40.5*(e-3))}clearEvent(){this.node.removeEventListener("click",this.handleClick)}}class o extends n{template(){const{isModalVisiable:e,selectedItem:t}=this.initalState;return`\n    <div class='${e?"item_info":"hide"}' >\n      <div class='modal'>\n        <button>X</button> \n        <a href='${t.url||""}' target='_blank'>\n          <img src='${t.img||""}' />\n        </a>\n        <p>웹툰 제목: ${t.title||""}</p>\n        <p>작가: ${t.author||""}</p>\n        <p>연재 사이트: ${t.service||""}</p>\n      </div>\n    </div>\n    `}}new class extends n{constructor({node:e}){super({node:e,initalState:{keyword:"",selectedIndex:0,listData:[],selectedItem:{},isResultListVisiable:!1,isModalVisiable:!1}})}setup(){this.setState(Object.assign(Object.assign({},this.initalState),(e=>{try{const e=localStorage.getItem("searchState");return e?JSON.parse(e):[]}catch(e){throw new Error(e)}})())),this.handleChange=((e,t)=>{let s;return t=>{s&&clearTimeout(s),s=window.setTimeout(e,200,t)}})((e=>{return t=this,n=void 0,a=function*(){const t=yield(e=>s(void 0,void 0,void 0,(function*(){return t=`https://korea-webtoon-api.herokuapp.com/search?keyword=${e}`,s(void 0,void 0,void 0,(function*(){try{const e=yield fetch(t);if(!e.ok)throw new Error("서버와의 연결이 불안정합니다!");return(yield e.json()).webtoons}catch(e){console.error(`에러가 발생했습니다! ${e.message}`)}}));var t})))(e);e&&t.length?this.setState({isResultListVisiable:!0,listData:t,keyword:e}):this.setState({isResultListVisiable:!1,selectedIndex:0,keyword:"",listData:[],selectedItem:{}})},new((i=void 0)||(i=Promise))((function(e,s){function r(e){try{o(a.next(e))}catch(e){s(e)}}function l(e){try{o(a.throw(e))}catch(e){s(e)}}function o(t){var s;t.done?e(t.value):(s=t.value,s instanceof i?s:new i((function(e){e(s)}))).then(r,l)}o((a=a.apply(t,n||[])).next())}));var t,n,i,a})),this.handleKeyChange=e=>{const{listData:t,selectedIndex:s}=this.initalState;if(["ArrowUp","ArrowDown","Enter","Escape"].includes(e.key)&&!t.length)return;const n=t.length-1;let i=s;switch(e.key){case"ArrowUp":i=0===s?n:i-1,this.setState({selectedIndex:i});break;case"ArrowDown":i=s===n?0:i+1,this.setState({selectedIndex:i});break;case"Enter":e.preventDefault(),this.setState({selectedItem:t[s],isModalVisiable:!0});break;case"Escape":this.setState({isModalVisiable:!1})}},this.handleClick=e=>{(e.target.closest("button")||e.target.classList.contains("item_info"))&&this.setState({isModalVisiable:!1})}}template(){return"\n      <main id='root'>\n        <header class='header'>Webtoons Search</header>\n        <div class='container'>\n          <SearchInput></SearchInput>\n          <SearchResultList></SearchResultList>\n          <SearchItemInfo></SearchItemInfo>\n        </div>\n      </main>\n  "}renderChildComponent(){const{keyword:t,selectedIndex:s,listData:n,isResultListVisiable:i,selectedItem:r,isModalVisiable:c}=this.initalState;new a({node:e(this.node,"SearchInput"),initalState:{keyword:this.initalState.keyword,onInput:this.handleChange}});const d=new l({node:e(this.node,"SearchResultList"),initalState:{keyword:t,listData:n,isResultListVisiable:i,selectedIndex:s,onClick:(e,t)=>{this.setState({selectedItem:e,isModalVisiable:!0,selectedIndex:Number(t)})}}}),h=new o({node:e(this.node,"SearchItemInfo"),initalState:{selectedItem:r,isModalVisiable:c}});this.subscribe(d),this.subscribe(h)}setEvent(){window.addEventListener("keyup",this.handleKeyChange),this.node.addEventListener("click",this.handleClick)}clearEvent(){window.removeEventListener("keyup",this.handleKeyChange),this.node.removeEventListener("click",this.handleClick)}}({node:e(document,"#root"),initalState:null})})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxTQUFTLENBQ1oyRCxhQUFjQSxFQUNkRCxpQkFBaUIsRUFDakJ6QixjQUFldUQsT0FBTzFDLElBQ3RCLEtBS0YyQyxFQUFpQixJQUFJaEMsRUFBZSxDQUN4Q3RHLEtBQU1SLEVBQVNPLEtBQUtDLEtBQU0sa0JBQzFCd0IsWUFBYSxDQUNYZ0YsZUFDQUQscUJBSUp4RyxLQUFLd0MsVUFBVTZGLEdBQ2ZySSxLQUFLd0MsVUFBVStGLEVBQ2pCLENBRUFuRyxXQUNFSCxPQUFPMkMsaUJBQWlCLFFBQVM1RSxLQUFLZ0ksaUJBQ3RDaEksS0FBS0MsS0FBSzJFLGlCQUFpQixRQUFTNUUsS0FBS2lHLFlBQzNDLENBRUExRCxhQUNFTixPQUFPNEMsb0JBQW9CLFFBQVM3RSxLQUFLZ0ksaUJBQ3pDaEksS0FBS0MsS0FBSzRFLG9CQUFvQixRQUFTN0UsS0FBS2lHLFlBQzlDLEdEdEtNLENBQUVoRyxLQUFNUixFQUFTRSxTQUFVLFNBQVU4QixZQUFhLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJ0b29ucy1zZWFyY2gvLi9zcmMvdXRpbHMvZG9tL2luZGV4LnRzIiwid2VicGFjazovL3dlYnRvb25zLXNlYXJjaC8uL3NyYy9jb21wb25lbnRzL2NvcmUvQ29tcG9uZW50LnRzIiwid2VicGFjazovL3dlYnRvb25zLXNlYXJjaC8uL3NyYy91dGlscy9zdG9yYWdlL2luZGV4LnRzIiwid2VicGFjazovL3dlYnRvb25zLXNlYXJjaC8uL3NyYy9jb21wb25lbnRzL3NlYXJjaC9TZWFyY2hJbnB1dC9TZWFyY2hJbnB1dC5tb2R1bGUuc2Nzcz8xNDcxIiwid2VicGFjazovL3dlYnRvb25zLXNlYXJjaC8uL3NyYy9jb21wb25lbnRzL3NlYXJjaC9TZWFyY2hJbnB1dC9pbmRleC50cyIsIndlYnBhY2s6Ly93ZWJ0b29ucy1zZWFyY2gvLi9zcmMvY29tcG9uZW50cy9zZWFyY2gvU2VhcmNoUmVzdWx0L1NlYXJjaFJlc3VsdC5tb2R1bGUuc2Nzcz8xYWI5Iiwid2VicGFjazovL3dlYnRvb25zLXNlYXJjaC8uL3NyYy9jb21wb25lbnRzL3NlYXJjaC9TZWFyY2hSZXN1bHQvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vd2VidG9vbnMtc2VhcmNoLy4vc3JjL2NvbXBvbmVudHMvc2VhcmNoL1NlYXJjaEl0ZW1JbmZvL2luZGV4LnRzIiwid2VicGFjazovL3dlYnRvb25zLXNlYXJjaC8uL3NyYy9tYWluLnRzIiwid2VicGFjazovL3dlYnRvb25zLXNlYXJjaC8uL3NyYy9BcHAudHMiLCJ3ZWJwYWNrOi8vd2VidG9vbnMtc2VhcmNoLy4vc3JjL3V0aWxzL2hlbHBlcnMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vd2VidG9vbnMtc2VhcmNoLy4vc3JjL2FwaS9pbmRleC50cyIsIndlYnBhY2s6Ly93ZWJ0b29ucy1zZWFyY2gvLi9zcmMvY29uc3RhbnRzL2FwaS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzZWxlY3RFbCA9IChcbiAgc2NvcGU6IEVsZW1lbnQgfCBEb2N1bWVudCA9IGRvY3VtZW50LFxuICBzZWxlY3Rvcjogc3RyaW5nXG4pOiBFbGVtZW50ID0+IHtcbiAgcmV0dXJuIHNjb3BlLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpXG59XG5cbmNvbnN0IHNlbGVjdEFsbCA9ICh7IHNjb3BlLCBzZWxlY3RvciB9OiBJU2VsZWN0VHlwZSk6IEVsZW1lbnRbXSA9PiB7XG4gIHJldHVybiBBcnJheS5mcm9tKHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKVxufVxuXG5jb25zdCBjcmVhdGVFbCA9ICh0YWdOYW1lOiBzdHJpbmcpOiBFbGVtZW50ID0+IHtcbiAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSlcbn1cblxuZnVuY3Rpb24gQ29udmVydFRlbXBsYXRlVG9Db21wb25lbnQodGhpczogYW55KTogdm9pZCB7XG4gIGNvbnN0IG9sZE5vZGUgPSB0aGlzLm5vZGVcbiAgY29uc3QgY29tcG9uZW50Q2hpbGRyZW4gPSBBcnJheS5mcm9tKFxuICAgIG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcodGhpcy50ZW1wbGF0ZSgpLCAndGV4dC9odG1sJykuYm9keS5jaGlsZHJlblxuICApXG4gIGNvbnN0IGNvbXBvbmVudCA9IG5ldyBEb2N1bWVudEZyYWdtZW50KClcbiAgY29tcG9uZW50LmFwcGVuZCguLi5jb21wb25lbnRDaGlsZHJlbilcblxuICBvbGROb2RlLmFmdGVyKGNvbXBvbmVudClcbiAgdGhpcy5ub2RlID0gb2xkTm9kZS5uZXh0U2libGluZ1xuXG4gIGNvbnN0IG9sZENTUyA9IG9sZE5vZGUuY2xhc3NMaXN0LnZhbHVlLnRyaW0oKVxuICBjb25zdCBuZXdDU1MgPSB0aGlzLm5vZGUuY2xhc3NMaXN0LnZhbHVlLnRyaW0oKVxuICBjb25zdCBpc0NoYW5nZWRDU1MgPSBvbGRDU1MgIT09IG5ld0NTU1xuICBjb25zdCBjc3NWYWx1ZSA9IGlzQ2hhbmdlZENTUyA/IG5ld0NTUyB8fCBvbGRDU1MgOiBvbGRDU1NcblxuICBpZiAoIWNzc1ZhbHVlKSB7XG4gICAgb2xkTm9kZS5yZW1vdmUoKVxuICAgIHJldHVyblxuICB9XG5cbiAgdGhpcy5ub2RlLmNsYXNzTmFtZSA9IGNzc1ZhbHVlXG5cbiAgb2xkTm9kZS5yZW1vdmUoKVxufVxuXG5leHBvcnQgeyBjcmVhdGVFbCwgc2VsZWN0RWwsIHNlbGVjdEFsbCwgQ29udmVydFRlbXBsYXRlVG9Db21wb25lbnQgfVxuXG5pbnRlcmZhY2UgSVNlbGVjdFR5cGUge1xuICBzY29wZTogRWxlbWVudCB8IERvY3VtZW50XG4gIHNlbGVjdG9yOiBzdHJpbmdcbn1cbiIsImltcG9ydCB7IENvbnZlcnRUZW1wbGF0ZVRvQ29tcG9uZW50IH0gZnJvbSAnQHV0aWxzJ1xuaW1wb3J0IHsgc2V0SXRlbSB9IGZyb20gJ0B1dGlscy9zdG9yYWdlJ1xuXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8U3RhdGVUeXBlPiB7XG4gIG5vZGU6IEVsZW1lbnRcbiAgaW5pdGFsU3RhdGU6IFN0YXRlVHlwZVxuICByZW5kZXJTdGF0ZUtleTogU2V0PHN0cmluZz5cbiAgc3Vic2NyaWJlcnM6IFNldDxhbnk+XG4gIGlzTmVlZFJlbmRlcjogYm9vbGVhblxuICBpc05lZWRVcGRhdGU6IGJvb2xlYW5cbiAgY29uc3RydWN0b3Ioe1xuICAgIG5vZGUsXG4gICAgaW5pdGFsU3RhdGUsXG4gICAgcmVuZGVyU3RhdGVLZXkgPSBbXVxuICB9OiBJQ29tcG9uZW50UHJvcHM8U3RhdGVUeXBlPikge1xuICAgIHRoaXMubm9kZSA9IG5vZGVcbiAgICB0aGlzLmluaXRhbFN0YXRlID0gaW5pdGFsU3RhdGVcbiAgICB0aGlzLnJlbmRlclN0YXRlS2V5ID0gbmV3IFNldChyZW5kZXJTdGF0ZUtleSlcbiAgICB0aGlzLnN1YnNjcmliZXJzID0gbmV3IFNldChbXSlcbiAgICB0aGlzLmlzTmVlZFJlbmRlciA9IGZhbHNlXG4gICAgdGhpcy5pc05lZWRVcGRhdGUgPSBmYWxzZVxuXG4gICAgdGhpcy5zZXR1cCgpXG4gICAgdGhpcy5yZW5kZXIoKVxuICB9XG5cbiAgc2V0dXAoKTogdm9pZCB7XG4gICAgcmV0dXJuXG4gIH1cblxuICByZW5kZXIoKTogdm9pZCB7XG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICBDb252ZXJ0VGVtcGxhdGVUb0NvbXBvbmVudC5jYWxsKHRoaXMpXG4gICAgICB0aGlzLnNldEV2ZW50KClcbiAgICAgIHRoaXMucmVuZGVyQ2hpbGRDb21wb25lbnQoKVxuICAgIH0pXG4gIH1cblxuICB1cGRhdGVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc05lZWRSZW5kZXIpIHtcbiAgICAgIHRoaXMucmVuZGVyQ2hpbGRDb21wb25lbnQoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy5jbGVhckV2ZW50KClcbiAgICB0aGlzLnJlbmRlcigpXG4gIH1cblxuICByZW5kZXJDaGlsZENvbXBvbmVudCgpOiB2b2lkIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHNldEV2ZW50KCk6IHZvaWQge1xuICAgIHJldHVyblxuICB9XG5cbiAgY2xlYXJFdmVudCgpOiB2b2lkIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHRlbXBsYXRlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICBzdWJzY3JpYmUoLi4uc3Vic2NyaWJlcnM6IGFueVtdKTogdm9pZCB7XG4gICAgc3Vic2NyaWJlcnMuZm9yRWFjaChzdWJzY3JpYmVyID0+IHtcbiAgICAgIHRoaXMuc3Vic2NyaWJlcnMuYWRkKHN1YnNjcmliZXIpXG4gICAgfSlcbiAgfVxuXG4gIG5vdGlmeShuZXdTdGF0ZTogYW55KTogdm9pZCB7XG4gICAgY29uc3Qgc3Vic2NyaWJlcnMgPSBBcnJheS5mcm9tKHRoaXMuc3Vic2NyaWJlcnMpXG5cbiAgICBzdWJzY3JpYmVycy5mb3JFYWNoKHN1YnNjcmliZXIgPT4ge1xuICAgICAgc3Vic2NyaWJlci5zZXRTdGF0ZShuZXdTdGF0ZSlcbiAgICAgIHN1YnNjcmliZXIudXBkYXRlcigpXG4gICAgICBzdWJzY3JpYmVyLmlzTmVlZFJlbmRlciA9IGZhbHNlXG4gICAgfSlcbiAgfVxuXG4gIHNldFN0YXRlKG5ld1N0YXRlOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLmNoZWNrVXBkYXRhU3RhdGUobmV3U3RhdGUpXG5cbiAgICBpZiAoIXRoaXMuaXNOZWVkVXBkYXRlKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aGlzLnJlZmxlY3ROZWVkUmVuZGVyKG5ld1N0YXRlKVxuICAgIHRoaXMucmVmbGVjdFN0YXRlKG5ld1N0YXRlKVxuICAgIHRoaXMubm90aWZ5KG5ld1N0YXRlKVxuXG4gICAgc2V0SXRlbSgnc2VhcmNoU3RhdGUnLCB0aGlzLmluaXRhbFN0YXRlKVxuICB9XG5cbiAgY2hlY2tVcGRhdGFTdGF0ZShuZXdTdGF0ZTogYW55KTogdm9pZCB7XG4gICAgY29uc3QgY3VycmVudFN0YXRlID0gSlNPTi5zdHJpbmdpZnkoeyAuLi50aGlzLmluaXRhbFN0YXRlIH0pXG4gICAgY29uc3QgbmV4dFN0YXRlID0gSlNPTi5zdHJpbmdpZnkoeyAuLi50aGlzLmluaXRhbFN0YXRlLCAuLi5uZXdTdGF0ZSB9KVxuXG4gICAgdGhpcy5pc05lZWRVcGRhdGUgPSBjdXJyZW50U3RhdGUgIT09IG5leHRTdGF0ZVxuICB9XG5cbiAgcmVmbGVjdE5lZWRSZW5kZXIobmV3U3RhdGU6IGFueSk6IHZvaWQge1xuICAgIGNvbnN0IHVwZGF0ZWRTdGF0ZUtleXMgPSBPYmplY3Qua2V5cyhuZXdTdGF0ZSlcbiAgICBjb25zdCByZW5kZXJTdGF0ZUtleSA9IEFycmF5LmZyb20odGhpcy5yZW5kZXJTdGF0ZUtleSlcblxuICAgIGNvbnN0IHN0YXRlID0gdXBkYXRlZFN0YXRlS2V5cy5maWx0ZXIoa2V5ID0+IHJlbmRlclN0YXRlS2V5LmluY2x1ZGVzKGtleSkpXG4gICAgdGhpcy5pc05lZWRSZW5kZXIgPSBzdGF0ZS5sZW5ndGggPT09IDBcbiAgfVxuXG4gIHJlZmxlY3RTdGF0ZShuZXdTdGF0ZTogYW55KTogdm9pZCB7XG4gICAgY29uc3QgdXBkYXRlZFN0YXRlS2V5cyA9IE9iamVjdC5rZXlzKG5ld1N0YXRlKVxuXG4gICAgdXBkYXRlZFN0YXRlS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBjb25zdCBzdGF0ZUtleSA9IGtleSBhcyBrZXlvZiBTdGF0ZVR5cGVcbiAgICAgIHRoaXMuaW5pdGFsU3RhdGVbc3RhdGVLZXldID0gbmV3U3RhdGVbXG4gICAgICAgIHN0YXRlS2V5XG4gICAgICBdIGFzIFN0YXRlVHlwZVtrZXlvZiBTdGF0ZVR5cGVdXG4gICAgfSlcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElDb21wb25lbnRQcm9wczxTdGF0ZVR5cGU+IHtcbiAgbm9kZTogRWxlbWVudFxuICBpbml0YWxTdGF0ZTogU3RhdGVUeXBlIHwgbnVsbFxuICByZW5kZXJTdGF0ZUtleT86IHN0cmluZ1tdXG59XG4iLCJjb25zdCBzZXRJdGVtID0gKGtleTogc3RyaW5nLCB2YWx1ZTogYW55KTogdm9pZCA9PiB7XG4gIHRyeSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGDsoIDsnqXsnbQg65CY7KeAIOyViuyVmOyKteuLiOuLpCFgKVxuICB9XG59XG5cbmNvbnN0IGdldEl0ZW0gPSAoa2V5OiBzdHJpbmcpOiBhbnkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KVxuICAgIHJldHVybiB2YWx1ZSA/IEpTT04ucGFyc2UodmFsdWUpIDogW11cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpXG4gIH1cbn1cblxuZXhwb3J0IHsgc2V0SXRlbSwgZ2V0SXRlbSB9XG4iLCIvLyBleHRyYWN0ZWQgYnkgbWluaS1jc3MtZXh0cmFjdC1wbHVnaW5cbmV4cG9ydCBkZWZhdWx0IHtcIlNlYXJjaElucHV0X19pbnB1dFwiOlwib1pGZFM4QU1qUjVSTVl5Qk52S1ZcIn07IiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnQGNvbXBvbmVudHMnXG5pbXBvcnQgc3R5bGVzIGZyb20gJy4vU2VhcmNoSW5wdXQubW9kdWxlLnNjc3MnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlYXJjaElucHV0IGV4dGVuZHMgQ29tcG9uZW50PElTZWFyY2hJbnB1dFN0YXRlPiB7XG4gIGhhbmRsZUlucHV0OiAoZTogYW55KSA9PiB2b2lkXG4gIGhhbmRsZUZvY3VzOiAoKSA9PiB2b2lkXG4gIHRlbXBsYXRlKCk6IHN0cmluZyB7XG4gICAgY29uc3QgeyBTZWFyY2hJbnB1dF9faW5wdXQgfSA9IHN0eWxlc1xuICAgIGNvbnN0IHsga2V5d29yZCB9ID0gdGhpcy5pbml0YWxTdGF0ZVxuXG4gICAgcmV0dXJuIGBcbiAgICAgIDxpbnB1dCBjbGFzcz0nJHtTZWFyY2hJbnB1dF9faW5wdXR9JyB0eXBlPSd0ZXh0JyBwbGFjZWhvbGRlcj0n7Ju57Yiw7KCc66qpLCDsnpHqsIDsnbTrpoTsnLzroZwg6rKA7IOJJyB2YWx1ZT0nJHtrZXl3b3JkfScvPlxuICAgIGBcbiAgfVxuXG4gIHNldHVwKCk6IHZvaWQge1xuICAgIGNvbnN0IHsgb25JbnB1dCB9ID0gdGhpcy5pbml0YWxTdGF0ZVxuXG4gICAgdGhpcy5oYW5kbGVJbnB1dCA9IChlKTogdm9pZCA9PiB7XG4gICAgICBvbklucHV0KGUudGFyZ2V0LnZhbHVlKVxuICAgIH1cblxuICAgIHRoaXMuaGFuZGxlRm9jdXMgPSAoKTogdm9pZCA9PiB7XG4gICAgICBjb25zdCAkaW5wdXQgPSB0aGlzLm5vZGUgYXMgSFRNTElucHV0RWxlbWVudFxuICAgICAgJGlucHV0LmZvY3VzKClcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudCgpOiB2b2lkIHtcbiAgICB0aGlzLm5vZGUuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmhhbmRsZUlucHV0KVxuICAgIHRoaXMuaGFuZGxlRm9jdXMoKVxuICB9XG5cbiAgY2xlYXJFdmVudCgpOiB2b2lkIHtcbiAgICB0aGlzLm5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLmhhbmRsZUlucHV0KVxuICB9XG59XG5cbmludGVyZmFjZSBJU2VhcmNoSW5wdXRTdGF0ZSB7XG4gIGtleXdvcmQ6IHN0cmluZ1xuICBvbklucHV0PyhrZXl3b3JkOiBzdHJpbmcpOiB2b2lkXG59XG4iLCIvLyBleHRyYWN0ZWQgYnkgbWluaS1jc3MtZXh0cmFjdC1wbHVnaW5cbmV4cG9ydCBkZWZhdWx0IHtcInJlc3VsdF9saXN0XCI6XCJoakNkY28yN2xKSlRvMm95Uk41d1wiLFwic2VsZWN0ZWRcIjpcInlxQnFXeGlSOUFTdEdCNThyTGZTXCIsXCJtYXRjaGVkXCI6XCJPQWY1SndrRDlvU09KV3BsV0tfMFwifTsiLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICdAY29tcG9uZW50cydcbmltcG9ydCBzdHlsZXMgZnJvbSAnLi9TZWFyY2hSZXN1bHQubW9kdWxlLnNjc3MnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlYXJjaFJlc3VsdCBleHRlbmRzIENvbXBvbmVudDxJU2VhcmNoUmVzdWx0U3RhdGU+IHtcbiAgaGFuZGxlQ2xpY2s6IChzZWxlY3RlZEl0ZW06IGFueSkgPT4gdm9pZFxuICBnZXRTY3JvbGxQb2lzaXRpb246ICgpID0+IHZvaWRcbiAgdGVtcGxhdGUoKTogc3RyaW5nIHtcbiAgICBjb25zdCB7IHNlbGVjdGVkSW5kZXgsIGlzUmVzdWx0TGlzdFZpc2lhYmxlLCBsaXN0RGF0YSwga2V5d29yZCB9ID1cbiAgICAgIHRoaXMuaW5pdGFsU3RhdGVcbiAgICBjb25zdCB7IHJlc3VsdF9saXN0LCBzZWxlY3RlZCwgbWF0Y2hlZCB9ID0gc3R5bGVzXG5cbiAgICBjb25zdCBtYXRjaEtleXdvcmQgPSAoaXRlbTogYW55LCBrZXl3b3JkOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgICAgaWYgKCFpdGVtLmluY2x1ZGVzKGtleXdvcmQpKSB7XG4gICAgICAgIHJldHVybiBpdGVtXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG1hdGNoVGV4dCA9IGl0ZW0ubWF0Y2gobmV3IFJlZ0V4cChrZXl3b3JkLCAnZ2knKSlbMF1cblxuICAgICAgcmV0dXJuIGl0ZW0ucmVwbGFjZShcbiAgICAgICAgbmV3IFJlZ0V4cChtYXRjaFRleHQsICdnaScpLFxuICAgICAgICBgPHNwYW4gY2xhc3M9JyR7bWF0Y2hlZH0nPiR7bWF0Y2hUZXh0fTwvc3Bhbj5gXG4gICAgICApXG4gICAgfVxuXG4gICAgcmV0dXJuIGBcbiAgICAgIDx1bCBjbGFzcz0nJHtcbiAgICAgICAgaXNSZXN1bHRMaXN0VmlzaWFibGUgPyBgJHtyZXN1bHRfbGlzdH1gIDogJ2hpZGUnXG4gICAgICB9Jz4ke0FycmF5LmZyb20obGlzdERhdGEpXG4gICAgICA/Lm1hcChcbiAgICAgICAgKGl0ZW0sIGluZGV4KSA9PlxuICAgICAgICAgIGA8bGkgY2xhc3M9JyR7XG4gICAgICAgICAgICBpbmRleCA9PT0gc2VsZWN0ZWRJbmRleCA/IGAke3NlbGVjdGVkfWAgOiAnJ1xuICAgICAgICAgIH0nIGRhdGEtaW5kZXg9JyR7aW5kZXh9Jz5cbiAgICAgICAgICAgICAgPHNwYW4+JHttYXRjaEtleXdvcmQoaXRlbS50aXRsZSwga2V5d29yZCl9PC9zcGFuPlxuICAgICAgICAgICAgICA8c3Bhbj5bICR7bWF0Y2hLZXl3b3JkKGl0ZW0uYXV0aG9yLCBrZXl3b3JkKX0gXSA8L3NwYW4+XG4gICAgICAgICAgICA8L2xpPmBcbiAgICAgIClcbiAgICAgIC5qb2luKCcnKX1cbiAgICAgIDwvdWw+XG4gICAgYFxuICB9XG5cbiAgc2V0dXAoKTogdm9pZCB7XG4gICAgY29uc3QgeyBvbkNsaWNrIH0gPSB0aGlzLmluaXRhbFN0YXRlXG5cbiAgICB0aGlzLmhhbmRsZUNsaWNrID0gKGUpOiB2b2lkID0+IHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0IGFzIEhUTUxFbGVtZW50XG4gICAgICBjb25zdCAkbGkgPSB0YXJnZXQuY2xvc2VzdCgnbGknKVxuICAgICAgaWYgKCRsaSkge1xuICAgICAgICBjb25zdCB7IGluZGV4IH0gPSAkbGkuZGF0YXNldFxuICAgICAgICBvbkNsaWNrKHRoaXMuaW5pdGFsU3RhdGUubGlzdERhdGFbcGFyc2VJbnQoaW5kZXgpXSwgaW5kZXgpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5ub2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljaylcblxuICAgIGNvbnN0IHsgc2VsZWN0ZWRJbmRleCB9ID0gdGhpcy5pbml0YWxTdGF0ZVxuXG4gICAgY29uc3QgdGVtcCA9IDQwLjUgLy9saSBzaXplXG4gICAgaWYgKChzZWxlY3RlZEluZGV4ID4gMCAmJiBzZWxlY3RlZEluZGV4IDw9IDMpIHx8IHNlbGVjdGVkSW5kZXggPT09IDApIHtcbiAgICAgIHRoaXMubm9kZS5zY3JvbGxUbygwLCAwKVxuICAgIH1cblxuICAgIGlmIChzZWxlY3RlZEluZGV4ID4gMykge1xuICAgICAgdGhpcy5ub2RlLnNjcm9sbFRvKDAsIHRlbXAgKiAoc2VsZWN0ZWRJbmRleCAtIDMpKVxuICAgIH1cbiAgfVxuXG4gIGNsZWFyRXZlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5ub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljaylcbiAgfVxufVxuXG5pbnRlcmZhY2UgSVNlYXJjaFJlc3VsdFN0YXRlIHtcbiAgaXNSZXN1bHRMaXN0VmlzaWFibGU6IGJvb2xlYW5cbiAgc2VsZWN0ZWRJbmRleDogbnVtYmVyXG4gIGxpc3REYXRhOiBJSXRlbVtdXG4gIGtleXdvcmQ6IHN0cmluZ1xuICBvbkNsaWNrKHNlbGVjdGVkSXRlbTogYW55LCBpbmRleDogc3RyaW5nKTogdm9pZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElJdGVtIHtcbiAgd2VidG9vbklkOiBudW1iZXJcbiAgdGl0bGU6IHN0cmluZ1xuICBhdXRob3I6IHN0cmluZ1xuICBpbWc6IHN0cmluZ1xuICBzZXJ2aWNlOiBzdHJpbmdcbiAgdXBkYXRlRGF5czogc3RyaW5nW11cbiAgdXJsOiBzdHJpbmdcbn1cbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0Bjb21wb25lbnRzJ1xuaW1wb3J0IHR5cGUgeyBJSXRlbSB9IGZyb20gJy4uL1NlYXJjaFJlc3VsdCdcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VhcmNoSXRlbUluZm8gZXh0ZW5kcyBDb21wb25lbnQ8SVNlYXJjaEl0ZW1JbmZvU3RhdGU+IHtcbiAgdGVtcGxhdGUoKTogc3RyaW5nIHtcbiAgICBjb25zdCB7IGlzTW9kYWxWaXNpYWJsZSwgc2VsZWN0ZWRJdGVtIH0gPSB0aGlzLmluaXRhbFN0YXRlXG4gICAgcmV0dXJuIGBcbiAgICA8ZGl2IGNsYXNzPScke2lzTW9kYWxWaXNpYWJsZSA/IGBpdGVtX2luZm9gIDogJ2hpZGUnfScgPlxuICAgICAgPGRpdiBjbGFzcz0nbW9kYWwnPlxuICAgICAgICA8YnV0dG9uPlg8L2J1dHRvbj4gXG4gICAgICAgIDxhIGhyZWY9JyR7c2VsZWN0ZWRJdGVtLnVybCB8fCAnJ30nIHRhcmdldD0nX2JsYW5rJz5cbiAgICAgICAgICA8aW1nIHNyYz0nJHtzZWxlY3RlZEl0ZW0uaW1nIHx8ICcnfScgLz5cbiAgICAgICAgPC9hPlxuICAgICAgICA8cD7sm7ntiLAg7KCc66qpOiAke3NlbGVjdGVkSXRlbS50aXRsZSB8fCAnJ308L3A+XG4gICAgICAgIDxwPuyekeqwgDogJHtzZWxlY3RlZEl0ZW0uYXV0aG9yIHx8ICcnfTwvcD5cbiAgICAgICAgPHA+7Jew7J6sIOyCrOydtO2KuDogJHtzZWxlY3RlZEl0ZW0uc2VydmljZSB8fCAnJ308L3A+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICBgXG4gIH1cbn1cblxuaW50ZXJmYWNlIElTZWFyY2hJdGVtSW5mb1N0YXRlIHtcbiAgc2VsZWN0ZWRJdGVtOiBJSXRlbVxuICBpc01vZGFsVmlzaWFibGU6IGJvb2xlYW5cbn1cbiIsImltcG9ydCB7IHNlbGVjdEVsIH0gZnJvbSAnQHV0aWxzJ1xuaW1wb3J0IEFwcCBmcm9tICdBcHAnXG5pbXBvcnQgJy4vc2Nzcy9pbmRleC5zY3NzJ1xuXG5uZXcgQXBwKHsgbm9kZTogc2VsZWN0RWwoZG9jdW1lbnQsICcjcm9vdCcpLCBpbml0YWxTdGF0ZTogbnVsbCB9KVxuIiwiaW1wb3J0IHsgYXBpIH0gZnJvbSAnQGFwaSdcbmltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgU2VhcmNoSW5wdXQsXG4gIFNlYXJjaFJlc3VsdCxcbiAgU2VhcmNoSXRlbUluZm9cbn0gZnJvbSAnQGNvbXBvbmVudHMnXG5pbXBvcnQgdHlwZSB7IElDb21wb25lbnRQcm9wcyB9IGZyb20gJ0Bjb21wb25lbnRzL2NvcmUvQ29tcG9uZW50J1xuaW1wb3J0IHR5cGUgeyBJSXRlbSB9IGZyb20gJ0Bjb21wb25lbnRzL3NlYXJjaC9TZWFyY2hSZXN1bHQnXG5pbXBvcnQgeyBkZWJvdW5jZSwgc2VsZWN0RWwgfSBmcm9tICdAdXRpbHMnXG5pbXBvcnQgeyBnZXRJdGVtIH0gZnJvbSAnQHV0aWxzL3N0b3JhZ2UnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcCBleHRlbmRzIENvbXBvbmVudDxJQXBwU3RhdGU+IHtcbiAgaGFuZGxlQ2hhbmdlOiAoa2V5d29yZDogc3RyaW5nKSA9PiB2b2lkXG4gIGhhbmRsZUtleUNoYW5nZTogKGU6IGFueSkgPT4gdm9pZFxuICBoYW5kbGVDbGljazogKGU6IGFueSkgPT4gdm9pZFxuICBjb25zdHJ1Y3Rvcih7IG5vZGUgfTogSUNvbXBvbmVudFByb3BzPElBcHBTdGF0ZT4pIHtcbiAgICBjb25zdCBpbml0YWxTdGF0ZSA9IHtcbiAgICAgIGtleXdvcmQ6ICcnLFxuICAgICAgc2VsZWN0ZWRJbmRleDogMCxcbiAgICAgIGxpc3REYXRhOiBbXSxcbiAgICAgIHNlbGVjdGVkSXRlbToge30sXG4gICAgICBpc1Jlc3VsdExpc3RWaXNpYWJsZTogZmFsc2UsXG4gICAgICBpc01vZGFsVmlzaWFibGU6IGZhbHNlXG4gICAgfSBhcyBJQXBwU3RhdGVcblxuICAgIHN1cGVyKHsgbm9kZSwgaW5pdGFsU3RhdGUgfSlcbiAgfVxuXG4gIHNldHVwKCk6IHZvaWQge1xuICAgIHRoaXMuc2V0U3RhdGUoeyAuLi50aGlzLmluaXRhbFN0YXRlLCAuLi5nZXRJdGVtKCdzZWFyY2hTdGF0ZScpIH0pXG4gICAgdGhpcy5oYW5kbGVDaGFuZ2UgPSBkZWJvdW5jZShhc3luYyAoa2V5d29yZCk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWNvbmZ1c2luZy12b2lkLWV4cHJlc3Npb25cbiAgICAgIGNvbnN0IGxpc3REYXRhID0gYXdhaXQgYXBpLmdldFdlYlRvb25MaXN0KGtleXdvcmQpXG4gICAgICBpZiAoIWtleXdvcmQgfHwgIWxpc3REYXRhLmxlbmd0aCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBpc1Jlc3VsdExpc3RWaXNpYWJsZTogZmFsc2UsXG4gICAgICAgICAgc2VsZWN0ZWRJbmRleDogMCxcbiAgICAgICAgICBrZXl3b3JkOiAnJyxcbiAgICAgICAgICBsaXN0RGF0YTogW10sXG4gICAgICAgICAgc2VsZWN0ZWRJdGVtOiB7fVxuICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgaXNSZXN1bHRMaXN0VmlzaWFibGU6IHRydWUsXG4gICAgICAgICAgbGlzdERhdGE6IGxpc3REYXRhLFxuICAgICAgICAgIGtleXdvcmQ6IGtleXdvcmRcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9LCAyMDApXG5cbiAgICB0aGlzLmhhbmRsZUtleUNoYW5nZSA9IChlKTogdm9pZCA9PiB7XG4gICAgICBjb25zdCB7IGxpc3REYXRhLCBzZWxlY3RlZEluZGV4IH0gPSB0aGlzLmluaXRhbFN0YXRlXG4gICAgICBjb25zdCBhY3Rpb25LZXlzID0gWydBcnJvd1VwJywgJ0Fycm93RG93bicsICdFbnRlcicsICdFc2NhcGUnXVxuXG4gICAgICBpZiAoYWN0aW9uS2V5cy5pbmNsdWRlcyhlLmtleSkgJiYgIWxpc3REYXRhLmxlbmd0aCkge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgY29uc3QgbGFzdEluZGV4ID0gbGlzdERhdGEubGVuZ3RoIC0gMVxuICAgICAgbGV0IG5leHRJbmRleCA9IHNlbGVjdGVkSW5kZXhcblxuICAgICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICBjYXNlICdBcnJvd1VwJzpcbiAgICAgICAgICBuZXh0SW5kZXggPSBzZWxlY3RlZEluZGV4ID09PSAwID8gbGFzdEluZGV4IDogbmV4dEluZGV4IC0gMVxuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2VsZWN0ZWRJbmRleDogbmV4dEluZGV4XG4gICAgICAgICAgfSlcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgIG5leHRJbmRleCA9IHNlbGVjdGVkSW5kZXggPT09IGxhc3RJbmRleCA/IDAgOiBuZXh0SW5kZXggKyAxXG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBzZWxlY3RlZEluZGV4OiBuZXh0SW5kZXhcbiAgICAgICAgICB9KVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgJ0VudGVyJzpcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNlbGVjdGVkSXRlbTogbGlzdERhdGFbc2VsZWN0ZWRJbmRleF0sXG4gICAgICAgICAgICBpc01vZGFsVmlzaWFibGU6IHRydWVcbiAgICAgICAgICB9KVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgJ0VzY2FwZSc6XG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc01vZGFsVmlzaWFibGU6IGZhbHNlXG4gICAgICAgICAgfSlcbiAgICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuaGFuZGxlQ2xpY2sgPSAoZSk6IHZvaWQgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBlLnRhcmdldC5jbG9zZXN0KCdidXR0b24nKSB8fFxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2l0ZW1faW5mbycpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgaXNNb2RhbFZpc2lhYmxlOiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHRlbXBsYXRlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBcbiAgICAgIDxtYWluIGlkPSdyb290Jz5cbiAgICAgICAgPGhlYWRlciBjbGFzcz0naGVhZGVyJz5XZWJ0b29ucyBTZWFyY2g8L2hlYWRlcj5cbiAgICAgICAgPGRpdiBjbGFzcz0nY29udGFpbmVyJz5cbiAgICAgICAgICA8U2VhcmNoSW5wdXQ+PC9TZWFyY2hJbnB1dD5cbiAgICAgICAgICA8U2VhcmNoUmVzdWx0TGlzdD48L1NlYXJjaFJlc3VsdExpc3Q+XG4gICAgICAgICAgPFNlYXJjaEl0ZW1JbmZvPjwvU2VhcmNoSXRlbUluZm8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9tYWluPlxuICBgXG4gIH1cblxuICByZW5kZXJDaGlsZENvbXBvbmVudCgpOiB2b2lkIHtcbiAgICBjb25zdCB7XG4gICAgICBrZXl3b3JkLFxuICAgICAgc2VsZWN0ZWRJbmRleCxcbiAgICAgIGxpc3REYXRhLFxuICAgICAgaXNSZXN1bHRMaXN0VmlzaWFibGUsXG4gICAgICBzZWxlY3RlZEl0ZW0sXG4gICAgICBpc01vZGFsVmlzaWFibGVcbiAgICB9ID0gdGhpcy5pbml0YWxTdGF0ZVxuXG4gICAgbmV3IFNlYXJjaElucHV0KHtcbiAgICAgIG5vZGU6IHNlbGVjdEVsKHRoaXMubm9kZSwgJ1NlYXJjaElucHV0JyksXG4gICAgICBpbml0YWxTdGF0ZToge1xuICAgICAgICBrZXl3b3JkOiB0aGlzLmluaXRhbFN0YXRlLmtleXdvcmQsXG4gICAgICAgIG9uSW5wdXQ6IHRoaXMuaGFuZGxlQ2hhbmdlXG4gICAgICB9XG4gICAgfSlcblxuICAgIGNvbnN0IHNlYXJjaFJlc3VsdCA9IG5ldyBTZWFyY2hSZXN1bHQoe1xuICAgICAgbm9kZTogc2VsZWN0RWwodGhpcy5ub2RlLCAnU2VhcmNoUmVzdWx0TGlzdCcpLFxuICAgICAgaW5pdGFsU3RhdGU6IHtcbiAgICAgICAga2V5d29yZCxcbiAgICAgICAgbGlzdERhdGEsXG4gICAgICAgIGlzUmVzdWx0TGlzdFZpc2lhYmxlLFxuICAgICAgICBzZWxlY3RlZEluZGV4LFxuICAgICAgICBvbkNsaWNrOiAoc2VsZWN0ZWRJdGVtOiBhbnksIGluZGV4OiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNlbGVjdGVkSXRlbTogc2VsZWN0ZWRJdGVtLFxuICAgICAgICAgICAgaXNNb2RhbFZpc2lhYmxlOiB0cnVlLFxuICAgICAgICAgICAgc2VsZWN0ZWRJbmRleDogTnVtYmVyKGluZGV4KVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgY29uc3Qgc2VhcmNoSXRlbUluZm8gPSBuZXcgU2VhcmNoSXRlbUluZm8oe1xuICAgICAgbm9kZTogc2VsZWN0RWwodGhpcy5ub2RlLCAnU2VhcmNoSXRlbUluZm8nKSxcbiAgICAgIGluaXRhbFN0YXRlOiB7XG4gICAgICAgIHNlbGVjdGVkSXRlbSxcbiAgICAgICAgaXNNb2RhbFZpc2lhYmxlXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMuc3Vic2NyaWJlKHNlYXJjaFJlc3VsdClcbiAgICB0aGlzLnN1YnNjcmliZShzZWFyY2hJdGVtSW5mbylcbiAgfVxuXG4gIHNldEV2ZW50KCk6IHZvaWQge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuaGFuZGxlS2V5Q2hhbmdlKVxuICAgIHRoaXMubm9kZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlQ2xpY2spXG4gIH1cblxuICBjbGVhckV2ZW50KCk6IHZvaWQge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuaGFuZGxlS2V5Q2hhbmdlKVxuICAgIHRoaXMubm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlQ2xpY2spXG4gIH1cbn1cblxuaW50ZXJmYWNlIElBcHBTdGF0ZSB7XG4gIGtleXdvcmQ6IHN0cmluZ1xuICBzZWxlY3RlZEluZGV4OiBudW1iZXJcbiAgbGlzdERhdGE6IElJdGVtW11cbiAgc2VsZWN0ZWRJdGVtOiBJSXRlbVxuICBpc1Jlc3VsdExpc3RWaXNpYWJsZTogYm9vbGVhblxuICBpc01vZGFsVmlzaWFibGU6IGJvb2xlYW5cbn1cbiIsImNvbnN0IGRlYm91bmNlOiBJRGVib3VuY2UgPSAoY2FsbGJhY2ssIGRlbGF5KSA9PiB7XG4gIGxldCB0aW1lb3V0OiBudW1iZXJcblxuICByZXR1cm4gZXZlbnQgPT4ge1xuICAgIGlmICh0aW1lb3V0KSB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dClcbiAgICB9XG5cbiAgICB0aW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoY2FsbGJhY2ssIGRlbGF5LCBldmVudClcbiAgfVxufVxuXG5leHBvcnQgeyBkZWJvdW5jZSB9XG5cbnR5cGUgSURlYm91bmNlID0gKFxuICBjYWxsYmFjazogKGV2ZW50OiBhbnkpID0+IHZvaWQsXG4gIGRlbGF5OiBudW1iZXJcbikgPT4gKGV2ZW50OiBhbnkpID0+IHZvaWRcbiIsImltcG9ydCB7IEJBU0VfVVJMLCBSRVFVU0VUX01FU1NBR0UgfSBmcm9tICdAY29uc3RhbnRzJ1xuXG5jb25zdCByZXF1c2V0ID0gYXN5bmMgKHVybDogc3RyaW5nKTogUHJvbWlzZTxhbnk+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybClcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoUkVRVVNFVF9NRVNTQUdFLkhUVFBfRVJST1IpXG4gICAgfVxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICByZXR1cm4gZGF0YS53ZWJ0b29uc1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYCR7UkVRVVNFVF9NRVNTQUdFLlNFUlZFUl9FUlJPUn0gJHtlcnJvci5tZXNzYWdlfWApXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGFwaSA9IHtcbiAgZ2V0V2ViVG9vbkxpc3Q6IGFzeW5jIChrZXl3b3JkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4gPT5cbiAgICByZXF1c2V0KGAke0JBU0VfVVJMfS9zZWFyY2g/a2V5d29yZD0ke2tleXdvcmR9YClcbn1cbiIsImNvbnN0IEJBU0VfVVJMID0gJ2h0dHBzOi8va29yZWEtd2VidG9vbi1hcGkuaGVyb2t1YXBwLmNvbSdcbmNvbnN0IFJFUVVTRVRfTUVTU0FHRSA9IHtcbiAgSFRUUF9FUlJPUjogJ+yEnOuyhOyZgOydmCDsl7DqsrDsnbQg67aI7JWI7KCV7ZWp64uI64ukIScsXG4gIFNFUlZFUl9FUlJPUjogJ+yXkOufrOqwgCDrsJzsg53tlojsirXri4jri6QhJ1xufVxuZXhwb3J0IHsgQkFTRV9VUkwsIFJFUVVTRVRfTUVTU0FHRSB9XG4iXSwibmFtZXMiOlsic2VsZWN0RWwiLCJzY29wZSIsImRvY3VtZW50Iiwic2VsZWN0b3IiLCJxdWVyeVNlbGVjdG9yIiwiQ29udmVydFRlbXBsYXRlVG9Db21wb25lbnQiLCJvbGROb2RlIiwidGhpcyIsIm5vZGUiLCJjb21wb25lbnRDaGlsZHJlbiIsIkFycmF5IiwiZnJvbSIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsInRlbXBsYXRlIiwiYm9keSIsImNoaWxkcmVuIiwiY29tcG9uZW50IiwiRG9jdW1lbnRGcmFnbWVudCIsImFwcGVuZCIsImFmdGVyIiwibmV4dFNpYmxpbmciLCJvbGRDU1MiLCJjbGFzc0xpc3QiLCJ2YWx1ZSIsInRyaW0iLCJuZXdDU1MiLCJjc3NWYWx1ZSIsImNsYXNzTmFtZSIsInJlbW92ZSIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwiaW5pdGFsU3RhdGUiLCJyZW5kZXJTdGF0ZUtleSIsIlNldCIsInN1YnNjcmliZXJzIiwiaXNOZWVkUmVuZGVyIiwiaXNOZWVkVXBkYXRlIiwic2V0dXAiLCJyZW5kZXIiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjYWxsIiwic2V0RXZlbnQiLCJyZW5kZXJDaGlsZENvbXBvbmVudCIsInVwZGF0ZXIiLCJjbGVhckV2ZW50Iiwic3Vic2NyaWJlIiwiZm9yRWFjaCIsInN1YnNjcmliZXIiLCJhZGQiLCJub3RpZnkiLCJuZXdTdGF0ZSIsInNldFN0YXRlIiwiY2hlY2tVcGRhdGFTdGF0ZSIsInJlZmxlY3ROZWVkUmVuZGVyIiwicmVmbGVjdFN0YXRlIiwia2V5IiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcnJvciIsIkVycm9yIiwiY3VycmVudFN0YXRlIiwibmV4dFN0YXRlIiwidXBkYXRlZFN0YXRlS2V5cyIsIk9iamVjdCIsImtleXMiLCJzdGF0ZSIsImZpbHRlciIsImluY2x1ZGVzIiwibGVuZ3RoIiwic3RhdGVLZXkiLCJTZWFyY2hJbnB1dCIsIlNlYXJjaElucHV0X19pbnB1dCIsImtleXdvcmQiLCJvbklucHV0IiwiaGFuZGxlSW5wdXQiLCJlIiwidGFyZ2V0IiwiaGFuZGxlRm9jdXMiLCJmb2N1cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiU2VhcmNoUmVzdWx0Iiwic2VsZWN0ZWRJbmRleCIsImlzUmVzdWx0TGlzdFZpc2lhYmxlIiwibGlzdERhdGEiLCJyZXN1bHRfbGlzdCIsInNlbGVjdGVkIiwibWF0Y2hlZCIsIm1hdGNoS2V5d29yZCIsIml0ZW0iLCJtYXRjaFRleHQiLCJtYXRjaCIsIlJlZ0V4cCIsInJlcGxhY2UiLCJtYXAiLCJpbmRleCIsInRpdGxlIiwiYXV0aG9yIiwiam9pbiIsIm9uQ2xpY2siLCJoYW5kbGVDbGljayIsIiRsaSIsImNsb3Nlc3QiLCJkYXRhc2V0IiwicGFyc2VJbnQiLCJzY3JvbGxUbyIsIlNlYXJjaEl0ZW1JbmZvIiwiaXNNb2RhbFZpc2lhYmxlIiwic2VsZWN0ZWRJdGVtIiwidXJsIiwiaW1nIiwic2VydmljZSIsInN1cGVyIiwiZ2V0SXRlbSIsInBhcnNlIiwiaGFuZGxlQ2hhbmdlIiwiY2FsbGJhY2siLCJkZWxheSIsInRpbWVvdXQiLCJldmVudCIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJkZWJvdW5jZSIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsImpzb24iLCJ3ZWJ0b29ucyIsImNvbnNvbGUiLCJtZXNzYWdlIiwiYXBpIiwiaGFuZGxlS2V5Q2hhbmdlIiwibGFzdEluZGV4IiwibmV4dEluZGV4IiwicHJldmVudERlZmF1bHQiLCJjb250YWlucyIsInNlYXJjaFJlc3VsdCIsIk51bWJlciIsInNlYXJjaEl0ZW1JbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==